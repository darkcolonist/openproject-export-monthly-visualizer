import{f as E,r as ee,e as te,h as V,i as le,j as P,k as se,m as ce,o as de,s as ue,q as pe,t as fe,u as ve,v as be,w as he}from"./index-DhrgWT4q.js";import{C as W,r as oe}from"./vendor-charts-Dqlli2kf.js";import{w as Y,o as Z,a as G,b as f,d as b,e,f as M,F as B,A as I,B as ae,u as N,t as k,D as re,r as R,c as C,n as U,l as X,E as J,k as A,j as xe,m as O}from"./vendor-CnOKNHKp.js";import"./vendor-exceljs-B3-f5COA.js";import"./vendor-xlsx-BrcMyRkh.js";import"./vendor-datepicker-ChPokmFs.js";/* empty css                        */const Q=["#60a5fa","#f87171","#34d399","#fbbf24","#a78bfa","#f472b6","#22d3ee","#fb923c","#818cf8","#a3e635","#2dd4bf","#e879f9","#94a3b8","#38bdf8","#fb7185","#c084fc"];function q(T){return Q[T%Q.length]}const me={class:"relative w-full h-80 transition-all overflow-hidden px-4"},ge={class:"chart-legend mb-2 flex flex-wrap gap-2 px-4 mt-2 max-h-24 overflow-y-auto"},ye={class:"text-slate-300"},we={class:"text-slate-500 text-[10px] ml-1"},_e={__name:"ChartSection",setup(T){W.register(...oe);const r=R(null),x=R(null),h=R(null),v=C(()=>V(E.value)),c=C(()=>te(E.value)),w=()=>{if(!r.value||!ee.value.length)return;x.value&&x.value.destroy();const s=r.value.getContext("2d"),u={};c.value.forEach(a=>{u[a]={},v.value.forEach(o=>u[a][o]=0)}),E.value.forEach(a=>{u[a.project]&&u[a.project][a.date]!==void 0&&(u[a.project][a.date]+=a.units)});const S=c.value.map(a=>({name:a,total:Object.values(u[a]).reduce((o,n)=>o+n,0)})).sort((a,o)=>o.total-a.total).map((a,o)=>({label:a.name,data:v.value.map(n=>u[a.name][n]||0),backgroundColor:q(o),borderWidth:0,borderRadius:2,barPercentage:.6}));x.value=re(new W(s,{type:"bar",data:{labels:v.value.map(a=>{const[o,n]=a.split("-");return new Date(parseInt(o),parseInt(n)-1).toLocaleString("en-US",{month:"short",year:"numeric"})}),datasets:S},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{mode:"index",intersect:!1,backgroundColor:"#0f172a",borderColor:"#334155",borderWidth:1,filter:a=>a.raw>0,callbacks:{footer:a=>`Total: ${a.reduce((n,L)=>n+L.parsed.y,0).toFixed(2)} h`}}},scales:{x:{stacked:!0,grid:{display:!1},ticks:{color:"#94a3b8"}},y:{stacked:!0,grid:{color:"#1e293b"},ticks:{color:"#94a3b8"},title:{display:!0,text:"Total Hours",color:"#64748b"}}}}}))};Y(E,()=>{w()}),Z(()=>{w();const s=h.value;if(!s)return;const u=m=>{const S=document.getElementById("scroll-content");S&&Math.abs(m.deltaY)>Math.abs(m.deltaX)&&(S.scrollTop+=m.deltaY,m.preventDefault())};s.addEventListener("wheel",u,{passive:!1})}),G(()=>{x.value&&x.value.destroy()});const d=()=>{if(r.value){const s=document.createElement("canvas");s.width=r.value.width,s.height=r.value.height;const u=s.getContext("2d");u.fillStyle="#0f172a",u.fillRect(0,0,s.width,s.height),u.drawImage(r.value,0,0);const m=document.createElement("a");m.download="Monthly_Project_Report.png",m.href=s.toDataURL("image/png",1),m.click()}},t=C(()=>{const s={};return E.value.forEach(u=>{s[u.project]||(s[u.project]=0),s[u.project]+=u.units}),c.value.map(u=>({name:u,total:s[u]||0})).sort((u,m)=>m.total-u.total)});return(s,u)=>(f(),b("div",{ref_key:"sectionRef",ref:h,id:"chart-section",class:"bg-slate-900 border-b border-slate-800 flex flex-col p-3 shrink-0 shadow-lg relative z-30 transition-all"},[e("div",{class:"flex justify-between items-start mb-2 shrink-0 px-4"},[u[1]||(u[1]=e("div",null,[e("h3",{class:"text-lg font-bold text-slate-100"},"Monthly Hours Trend"),e("p",{class:"text-xs text-slate-500"},[M("Stacked by "),e("span",{class:"font-bold text-blue-400"},"Project")])],-1)),e("div",{class:"flex items-center gap-2"},[e("button",{onClick:d,class:"text-xs font-medium text-slate-400 hover:text-white flex items-center gap-1 bg-slate-800 px-3 py-1.5 rounded-full border border-slate-700 hover:bg-slate-700 transition-colors"},[...u[0]||(u[0]=[e("i",{class:"ph ph-download-simple"},null,-1),M(" Save Image ",-1)])])])]),e("div",me,[e("canvas",{ref_key:"chartRef",ref:r},null,512)]),e("div",ge,[(f(!0),b(B,null,I(t.value,(m,S)=>(f(),b("div",{key:m.name,class:"legend-item flex items-center gap-1.5 px-2 py-1 rounded bg-slate-800/50 text-xs"},[e("div",{class:"w-3 h-3 rounded",style:ae({backgroundColor:N(q)(S)})},null,4),e("span",ye,k(m.name),1),e("span",we,"("+k(m.total.toFixed(1))+" h)",1)]))),128))])],512))}},ke={id:"project-section",class:"flex flex-col p-0 overflow-hidden shrink-0 table-section"},Ce={class:"px-8 pb-8"},je={class:"bg-slate-900 rounded-xl border border-slate-800"},Se={class:"table-scroll-wrapper overflow-x-auto"},$e={id:"project-table",class:"text-sm text-left border-collapse",style:{"min-width":"100%"}},Ee={id:"project-thead",class:"text-xs text-slate-400 uppercase bg-slate-800"},Le={class:"px-4 py-3 font-medium text-slate-200 sticky left-0 bg-slate-900 z-10 border-r border-slate-800"},Te={class:"px-4 py-3 text-right font-bold text-blue-400"},Re={__name:"ProjectSection",setup(T){const r=C(()=>V(E.value)),x=C(()=>te(E.value)),h=C(()=>{const d={};return x.value.forEach(t=>{d[t]={total:0},r.value.forEach(s=>d[t][s]=0)}),E.value.forEach(t=>{d[t.project]&&(d[t.project][t.date]=(d[t.project][t.date]||0)+t.units,d[t.project].total+=t.units)}),d}),v=C(()=>[...x.value].sort((d,t)=>h.value[t].total-h.value[d].total)),c=d=>{const[t,s]=d.split("-");return new Date(parseInt(t),parseInt(s)-1).toLocaleString("en-US",{month:"short",year:"numeric"})},w=d=>{const t=d||0,s=t===0;return{text:t.toFixed(1)+"h",class:s?"text-slate-600":"text-slate-300"}};return(d,t)=>(f(),b("div",ke,[t[2]||(t[2]=e("div",{class:"p-3 bg-slate-950 shrink-0"},[e("h3",{class:"text-xs font-bold text-slate-100 flex items-center gap-2 px-5"},[e("i",{class:"ph ph-briefcase text-blue-400"}),M(" Project Breakdown ")])],-1)),e("div",Ce,[e("div",je,[e("div",Se,[e("table",$e,[e("thead",Ee,[e("tr",null,[t[0]||(t[0]=e("th",{class:"px-4 py-3 sticky left-0 bg-slate-800 z-20 border-b border-r border-slate-700 font-semibold"},"Project",-1)),(f(!0),b(B,null,I(r.value,s=>(f(),b("th",{key:s,class:"px-4 py-3 text-right border-b border-r border-slate-700 font-semibold whitespace-nowrap"},k(c(s)),1))),128)),t[1]||(t[1]=e("th",{class:"px-4 py-3 text-right font-bold text-blue-400 border-b border-slate-700"},"Total",-1))])]),e("tbody",null,[(f(!0),b(B,null,I(v.value,(s,u)=>(f(),b("tr",{key:s,class:U(["hover:bg-slate-800/50 transition-colors",u<v.value.length-1?"border-b border-slate-800":""])},[e("td",Le,k(s),1),(f(!0),b(B,null,I(r.value,m=>(f(),b("td",{key:m,class:U(["px-4 py-3 text-right border-r border-slate-800/50",w(h.value[s][m]).class])},k(w(h.value[s][m]).text),3))),128)),e("td",Te,k(h.value[s].total.toFixed(1))+"h",1)],2))),128))])])])])])]))}},De={id:"developer-section",class:"flex flex-col p-0 overflow-hidden shrink-0 table-section"},Be={class:"px-8 pb-8"},Ie={class:"bg-slate-900 rounded-xl border border-slate-800"},Fe={class:"table-scroll-wrapper overflow-x-auto"},Pe={id:"developer-table",class:"text-sm text-left border-collapse",style:{"min-width":"100%"}},Ue={id:"developer-thead",class:"text-xs text-slate-400 uppercase bg-slate-800"},Me={class:"px-4 py-3 font-medium text-slate-200 sticky left-0 bg-slate-900 z-10 border-r border-slate-800"},ze={class:"px-4 py-3 text-right font-bold text-blue-400"},He={__name:"DeveloperSection",setup(T){const r=C(()=>V(E.value)),x=C(()=>le(E.value)),h=C(()=>{const d={};return x.value.forEach(t=>{d[t]={total:0},r.value.forEach(s=>d[t][s]=0)}),E.value.forEach(t=>{d[t.user]&&(d[t.user][t.date]=(d[t.user][t.date]||0)+t.units,d[t.user].total+=t.units)}),d}),v=C(()=>[...x.value].sort((d,t)=>h.value[t].total-h.value[d].total)),c=d=>{const[t,s]=d.split("-");return new Date(parseInt(t),parseInt(s)-1).toLocaleString("en-US",{month:"short",year:"numeric"})},w=d=>{const t=d||0,s=t===0;return{text:t.toFixed(1)+"h",class:s?"text-slate-600":"text-slate-300"}};return(d,t)=>(f(),b("div",De,[t[2]||(t[2]=e("div",{class:"p-3 bg-slate-950 shrink-0"},[e("h3",{class:"text-xs font-bold text-slate-100 flex items-center gap-2 px-5"},[e("i",{class:"ph ph-users text-blue-400"}),M(" Developer Breakdown ")])],-1)),e("div",Be,[e("div",Ie,[e("div",Fe,[e("table",Pe,[e("thead",Ue,[e("tr",null,[t[0]||(t[0]=e("th",{class:"px-4 py-3 sticky left-0 bg-slate-800 z-20 border-b border-r border-slate-700 font-semibold"},"Developer",-1)),(f(!0),b(B,null,I(r.value,s=>(f(),b("th",{key:s,class:"px-4 py-3 text-right border-b border-r border-slate-700 font-semibold whitespace-nowrap"},k(c(s)),1))),128)),t[1]||(t[1]=e("th",{class:"px-4 py-3 text-right font-bold text-blue-400 border-b border-slate-700"},"Total",-1))])]),e("tbody",null,[(f(!0),b(B,null,I(v.value,(s,u)=>(f(),b("tr",{key:s,class:U(["hover:bg-slate-800/50 transition-colors",u<v.value.length-1?"border-b border-slate-800":""])},[e("td",Me,k(s),1),(f(!0),b(B,null,I(r.value,m=>(f(),b("td",{key:m,class:U(["px-4 py-3 text-right border-r border-slate-800/50",w(h.value[s][m]).class])},k(w(h.value[s][m]).text),3))),128)),e("td",ze,k(h.value[s].total.toFixed(1))+"h",1)],2))),128))])])])])])]))}},Oe={id:"insights-section",class:"flex flex-col p-0 overflow-hidden shrink-0 table-section mb-10"},Ae={class:"px-8"},Ne={class:"bg-slate-900 rounded-xl border border-slate-800 p-6"},We={class:"flex flex-wrap gap-4 mb-6"},qe={class:"flex flex-col gap-1 w-full sm:w-64"},Ve={class:"relative"},Ke=["value"],Ye={class:"flex flex-col gap-1 w-full sm:w-64"},Ze={class:"relative"},Ge=["disabled"],Xe=["value"],Je={class:"relative w-full h-96"},Qe={key:0,class:"absolute inset-0 flex items-center justify-center text-slate-500 text-sm"},et={key:0,class:"chart-legend mt-4 flex flex-wrap gap-2 max-h-24 overflow-y-auto"},tt={class:"text-slate-300"},lt={class:"text-slate-500 text-[10px] ml-1"},st={__name:"InsightsSection",setup(T){W.register(...oe);const r=R(""),x=R("all"),h=R(null),v=R(null),c=C(()=>le(E.value)),w=C(()=>{const a={};return c.value.forEach(o=>{a[o]=0,P.value[o]&&Object.values(P.value[o]).forEach(n=>{Object.values(n).forEach(L=>a[o]+=L)})}),a}),d=C(()=>[...c.value].sort((a,o)=>w.value[o]-w.value[a])),t=C(()=>r.value&&P.value[r.value]?Object.keys(P.value[r.value]).sort():[]),s=C(()=>{const a={};return r.value&&P.value[r.value]&&Object.entries(P.value[r.value]).forEach(([o,n])=>{a[o]=Object.values(n).reduce((L,H)=>L+H,0)}),a}),u=()=>{if(!h.value||!r.value){v.value&&(v.value.destroy(),v.value=null);return}const a=P.value[r.value]||{},o=new Set;Object.values(a).forEach(l=>{Object.keys(l).forEach(i=>o.add(i))});const n=Array.from(o).sort();let L=x.value==="all"?Object.keys(a):[x.value];L=L.filter(l=>a[l]).map(l=>({name:l,total:Object.values(a[l]).reduce((i,g)=>i+g,0)})).sort((l,i)=>i.total-l.total).map(l=>l.name);const H=L.map((l,i)=>{const g=n.map(y=>a[l]?.[y]||0);return{label:l,data:g,backgroundColor:q(i),borderWidth:0,borderRadius:2,barPercentage:.6}});v.value&&v.value.destroy();const p=h.value.getContext("2d");v.value=re(new W(p,{type:"bar",data:{labels:n.map(l=>{const[i,g]=l.split("-");return new Date(parseInt(i),parseInt(g)-1).toLocaleString("en-US",{month:"short",year:"numeric"})}),datasets:H},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{mode:"index",intersect:!1,backgroundColor:"#0f172a",borderColor:"#334155",borderWidth:1,filter:l=>l.raw>0,callbacks:{footer:l=>`Total: ${l.reduce((g,y)=>g+y.parsed.y,0).toFixed(2)} h`}}},scales:{x:{stacked:!0,grid:{display:!1},ticks:{color:"#94a3b8"}},y:{stacked:!0,grid:{color:"#1e293b"},ticks:{color:"#94a3b8"},title:{display:!0,text:"Hours Spent",color:"#64748b"}}}}}))},m=()=>{x.value="all"};Y([r,x,P],()=>{requestAnimationFrame(u)}),Z(()=>{u()}),G(()=>{v.value&&v.value.destroy()});const S=C(()=>r.value?(x.value==="all"?t.value:[x.value]).filter(o=>s.value[o]>0).sort((o,n)=>(s.value[n]||0)-(s.value[o]||0)):[]);return(a,o)=>(f(),b("div",Oe,[o[8]||(o[8]=e("div",{class:"p-3 bg-slate-950 shrink-0 flex justify-between items-center"},[e("h3",{class:"text-xs font-bold text-slate-100 flex items-center gap-2 px-5"},[e("i",{class:"ph ph-chart-bar text-blue-400"}),M(" Developer Project Insights ")])],-1)),e("div",Ae,[e("div",Ne,[e("div",We,[e("div",qe,[o[4]||(o[4]=e("label",{class:"text-xs text-slate-400 font-medium"},"Select Developer",-1)),e("div",Ve,[X(e("select",{"onUpdate:modelValue":o[0]||(o[0]=n=>r.value=n),onChange:m,class:"w-full bg-slate-800 border border-slate-700 text-slate-200 text-sm rounded-lg p-2.5 focus:ring-blue-500 focus:border-blue-500 appearance-none"},[o[2]||(o[2]=e("option",{value:""},"Select a Developer...",-1)),(f(!0),b(B,null,I(d.value,n=>(f(),b("option",{key:n,value:n},k(n)+" ("+k(w.value[n].toFixed(1))+" h) ",9,Ke))),128))],544),[[J,r.value]]),o[3]||(o[3]=e("i",{class:"ph ph-caret-down absolute right-3 top-3 text-slate-400 pointer-events-none"},null,-1))])]),e("div",Ye,[o[7]||(o[7]=e("label",{class:"text-xs text-slate-400 font-medium"},"Filter by Project",-1)),e("div",Ze,[X(e("select",{"onUpdate:modelValue":o[1]||(o[1]=n=>x.value=n),disabled:!r.value,class:"w-full bg-slate-800 border border-slate-700 text-slate-200 text-sm rounded-lg p-2.5 focus:ring-blue-500 focus:border-blue-500 appearance-none disabled:opacity-50"},[o[5]||(o[5]=e("option",{value:"all"},"All Projects",-1)),(f(!0),b(B,null,I(t.value,n=>(f(),b("option",{key:n,value:n},k(n)+" ("+k((s.value[n]||0).toFixed(1))+" h) ",9,Xe))),128))],8,Ge),[[J,x.value]]),o[6]||(o[6]=e("i",{class:"ph ph-caret-down absolute right-3 top-3 text-slate-400 pointer-events-none"},null,-1))])])]),e("div",Je,[e("canvas",{ref_key:"chartRef",ref:h},null,512),r.value?A("",!0):(f(),b("div",Qe," Select a developer to view insights "))]),r.value?(f(),b("div",et,[(f(!0),b(B,null,I(S.value,(n,L)=>(f(),b("div",{key:n,class:"legend-item flex items-center gap-1.5 px-2 py-1 rounded bg-slate-800/50 text-xs"},[e("div",{class:"w-3 h-3 rounded",style:ae({backgroundColor:N(q)(L)})},null,4),e("span",tt,k(n),1),e("span",lt,"("+k((s.value[n]||0).toFixed(1))+" h)",1)]))),128))])):A("",!0)])])]))}},ot={class:"fixed bottom-20 right-6 flex flex-col gap-2 z-50"},at={__name:"FloatingNav",props:["activeSection"],emits:["scrollTo"],setup(T,{emit:r}){const x=r,h=v=>{const c=document.getElementById("scroll-content"),w=document.getElementById(v);if(v==="chart-section"){c&&(c.scrollTop=0);return}if(w&&c){const d=w.offsetTop;c.scrollTo({top:d,behavior:"smooth"})}x("scrollTo",v)};return(v,c)=>(f(),b("div",ot,[e("button",{onClick:c[0]||(c[0]=w=>h("chart-section")),class:U(["nav-btn w-10 h-10 rounded-full border border-slate-700 shadow-lg hover:bg-slate-700 hover:scale-110 transition-all flex items-center justify-center",T.activeSection==="chart-section"?"active bg-blue-600 text-white":"bg-slate-800 text-blue-400"]),title:"Top"},[...c[4]||(c[4]=[e("i",{class:"ph ph-arrow-up"},null,-1)])],2),e("button",{onClick:c[1]||(c[1]=w=>h("project-section")),class:U(["nav-btn w-10 h-10 rounded-full border border-slate-700 shadow-lg hover:bg-slate-700 hover:scale-110 transition-all flex items-center justify-center",T.activeSection==="project-section"?"active bg-blue-600 text-white":"bg-slate-800 text-blue-400"]),title:"Projects"},[...c[5]||(c[5]=[e("i",{class:"ph ph-briefcase"},null,-1)])],2),e("button",{onClick:c[2]||(c[2]=w=>h("developer-section")),class:U(["nav-btn w-10 h-10 rounded-full border border-slate-700 shadow-lg hover:bg-slate-700 hover:scale-110 transition-all flex items-center justify-center",T.activeSection==="developer-section"?"active bg-blue-600 text-white":"bg-slate-800 text-blue-400"]),title:"Developers"},[...c[6]||(c[6]=[e("i",{class:"ph ph-users"},null,-1)])],2),e("button",{onClick:c[3]||(c[3]=w=>h("insights-section")),class:U(["nav-btn w-10 h-10 rounded-full border border-slate-700 shadow-lg hover:bg-slate-700 hover:scale-110 transition-all flex items-center justify-center",T.activeSection==="insights-section"?"active bg-blue-600 text-white":"bg-slate-800 text-blue-400"]),title:"Insights"},[...c[7]||(c[7]=[e("i",{class:"ph ph-chart-bar"},null,-1)])],2)]))}},rt={class:"w-full bg-slate-900 border-t border-slate-800 p-3 shrink-0 z-40 relative"},nt={class:"max-w-7xl mx-auto flex flex-wrap items-center justify-center gap-6"},it={class:"text-xs text-slate-400 font-medium"},ct={__name:"Footer",setup(T){const r=C(()=>V(E.value)),x=()=>{navigator.clipboard.writeText(window.location.href)};return(h,v)=>(f(),b("footer",rt,[e("div",nt,[e("span",it," Source: "+k(N(se)||"No File")+" | "+k(r.value.length)+" Months Displayed ",1),e("div",{class:"flex items-center gap-4"},[e("button",{onClick:x,class:"text-xs text-slate-400 hover:text-blue-400 flex items-center gap-1 transition-colors",title:"Copy URL from address bar"},[...v[0]||(v[0]=[e("i",{class:"ph ph-link"},null,-1),M(" Copy URL ",-1)])]),v[1]||(v[1]=e("div",{class:"w-px h-3 bg-slate-700 mx-1"},null,-1)),v[2]||(v[2]=e("a",{href:"https://github.com/darkcolonist/openproject-export-monthly-visualizer",target:"_blank",rel:"noopener noreferrer",class:"text-xs text-slate-400 hover:text-blue-400 flex items-center gap-1 transition-colors"},[e("i",{class:"ph ph-github-logo"}),M(" GitHub ")],-1))])])]))}},dt={class:"w-full h-full flex flex-col relative"},ut={class:"fixed bottom-24 right-8 flex flex-col gap-3 z-30"},pt=["disabled"],ft={key:0,class:"ph ph-cloud-arrow-up text-2xl group-hover:animate-bounce"},vt={key:1,class:"ph ph-spinner animate-spin text-2xl"},bt={key:0,class:"fixed bottom-8 left-1/2 -translate-x-1/2 z-50 animate-in fade-in slide-in-from-bottom-4 duration-500"},ht={class:"bg-slate-900 border border-emerald-500/30 rounded-2xl p-4 shadow-2xl flex items-center gap-4 max-w-lg"},xt={class:"flex-1 min-w-0"},mt={class:"text-[10px] text-slate-400 truncate"},gt={class:"flex gap-2"},$t={__name:"Dashboard",setup(T){const r=R(null),x=R("chart-section"),h=R(null),v=()=>{const p=r.value;if(!p)return;const l=p.scrollTop,i=["chart-section","project-section","developer-section","insights-section"];let g="chart-section";for(const y of i){const _=document.getElementById(y);if(_){const D=y==="chart-section"?0:_.offsetTop-100;l>=D&&(g=y)}}x.value=g,S()};let c=null,w=null,d=[];function t(p){const l=r.value,i=l.getBoundingClientRect();return p.getBoundingClientRect().top-i.top+l.scrollTop}function s(p,l,i){if(!p||!i||!l)return;const g=p.querySelectorAll("th"),y=i.querySelectorAll("th"),_=i.closest("table");_&&(_.style.tableLayout="fixed",_.style.width=l.scrollWidth+"px",_.style.minWidth=l.scrollWidth+"px"),g.forEach((D,j)=>{if(y[j]){y[j].style.boxSizing="border-box";const F=D.getBoundingClientRect().width+"px";y[j].style.width=F,y[j].style.minWidth=F,y[j].style.maxWidth=F}})}function u(p,l,i){const g=h.value;if(!g)return;const y=p.id,_=g.querySelector(".floating-header-inner");if(_){const z=i.getBoundingClientRect(),ie=g.getBoundingClientRect();_.style.marginLeft=z.left-ie.left+"px",_.style.width=z.width+"px",_.scrollLeft=i.scrollLeft}if(y===c)return;const D=p.cloneNode(!0),j=document.createElement("table");j.className=l.className,j.style.cssText=l.style.cssText,j.style.tableLayout="fixed",j.style.width=l.scrollWidth+"px",j.style.marginBottom="0",j.appendChild(D);const $=document.createElement("div");$.className="floating-header-inner";const F=i.getBoundingClientRect(),K=g.getBoundingClientRect();$.style.marginLeft=F.left-K.left+"px",$.style.width=F.width+"px",$.style.marginRight="0",$.style.padding="0",$.appendChild(j),g.innerHTML="",g.appendChild($),g.classList.add("active"),$.scrollLeft=i.scrollLeft,requestAnimationFrame(()=>{s(p,l,D)});const ne=()=>{const z=w;z&&Math.abs(z.scrollLeft-$.scrollLeft)>1&&(z.scrollLeft=$.scrollLeft)};$.addEventListener("scroll",ne),c=y,w=i}function m(){const p=h.value;p&&p.classList.contains("active")&&(p.classList.remove("active"),p.innerHTML="",c=null,w=null)}function S(){const p=r.value;if(!p)return;const l=document.getElementById("project-thead"),i=document.getElementById("project-table"),g=document.getElementById("developer-thead"),y=document.getElementById("developer-table");if(!l||!i||!g||!y)return;const _=p.scrollTop,D=l.offsetHeight||0,j=t(i),$=j+i.offsetHeight,F=t(y),K=F+y.offsetHeight;_>=j&&_<$-D?u(l,i,i.parentElement):_>=F&&_<K-D?u(g,y,y.parentElement):m()}const a=p=>{const l=document.getElementById(p);if(l&&l.parentElement){const i=l.parentElement,g=h.value,y=()=>{const _=g?.querySelector(".floating-header-inner");_&&(p==="project-table"&&c==="project-thead"||p==="developer-table"&&c==="developer-thead")&&Math.abs(_.scrollLeft-i.scrollLeft)>1&&(_.scrollLeft=i.scrollLeft)};i.addEventListener("scroll",y),d.push({el:i,fn:y})}};Z(()=>{const p=r.value;p&&p.addEventListener("scroll",v),window.addEventListener("resize",S),setTimeout(()=>{a("project-table"),a("developer-table"),S()},400)}),G(()=>{const p=r.value;p&&p.removeEventListener("scroll",v),window.removeEventListener("resize",S),d.forEach(({el:l,fn:i})=>l.removeEventListener("scroll",i))}),Y(E,()=>{setTimeout(S,100)});const o=R(null),n=R(!1),L=async()=>{if(!ue.value){alert("Please configure DigitalOcean Spaces in Settings first.");return}try{n.value=!0;const p={accessKey:be.value,secretKey:ve.value,endpoint:fe.value,bucket:pe.value},l=await he(ee.value,se.value||"export",p);o.value=l}catch(p){alert(p.message)}finally{n.value=!1}},H=p=>{navigator.clipboard.writeText(p).then(()=>{alert("URL copied to clipboard!")})};return(p,l)=>(f(),b("div",dt,[N(ce)?(f(),xe(_e,{key:0})):A("",!0),e("div",{id:"scroll-content",ref_key:"scrollRef",ref:r,class:"flex-1 overflow-y-auto relative bg-slate-950"},[e("div",{id:"floating-header",ref_key:"floatingHeaderRef",ref:h,class:"floating-sticky-header"},null,512),O(Re),O(He),O(st),O(ct),O(at,{activeSection:x.value},null,8,["activeSection"]),e("div",ut,[N(de)?(f(),b("button",{key:0,onClick:L,disabled:n.value,class:"bg-emerald-600 hover:bg-emerald-500 disabled:bg-emerald-800 text-white w-14 h-14 rounded-full shadow-2xl flex items-center justify-center transition-all hover:scale-110 active:scale-95 group",title:"Upload to DO Spaces"},[n.value?(f(),b("i",vt)):(f(),b("i",ft))],8,pt)):A("",!0)]),o.value?(f(),b("div",bt,[e("div",ht,[l[5]||(l[5]=e("div",{class:"w-10 h-10 bg-emerald-500/20 rounded-full flex items-center justify-center shrink-0"},[e("i",{class:"ph ph-check text-emerald-400 text-xl"})],-1)),e("div",xt,[l[2]||(l[2]=e("p",{class:"text-sm font-bold text-slate-100 mb-0.5"},"Uploaded Successfully!",-1)),e("p",mt,k(o.value),1)]),e("div",gt,[e("button",{onClick:l[0]||(l[0]=i=>H(o.value)),class:"p-2 hover:bg-slate-800 rounded-lg text-emerald-400 transition-colors",title:"Copy URL"},[...l[3]||(l[3]=[e("i",{class:"ph ph-copy text-xl"},null,-1)])]),e("button",{onClick:l[1]||(l[1]=i=>o.value=null),class:"p-2 hover:bg-slate-800 rounded-lg text-slate-500 transition-colors"},[...l[4]||(l[4]=[e("i",{class:"ph ph-x text-lg"},null,-1)])])])])])):A("",!0)],512)]))}};export{$t as default};
